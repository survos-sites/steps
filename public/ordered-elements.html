<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Install & Use: example/bundle — Reveal.js talk</title>

    <!-- Reveal.js (CDN) -->
    <link rel="stylesheet" href="https://unpkg.com/reveal.js@4/dist/reveal.css">
    <link rel="stylesheet" href="https://unpkg.com/reveal.js@4/dist/theme/black.css" id="theme">

    <!-- Highlight.js (for syntax highlighting) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css">

    <style>
        /* Small custom styles for readability */
        pre code { font-size: 1.05rem; line-height: 1.35rem; }
        .code-block { max-height: 62vh; overflow: auto; padding-right: 1rem; }
        .hl-line { display: block; background: rgba(255,235,59,0.08); border-left: 3px solid #ffeb3b; padding-left: 0.5rem; }
        .large-mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace; font-size: 1.15rem; }
        .fragment { transition: opacity 0.35s ease; }

        /* Callout / icon styles */
        .callout-row {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-top: 0.75rem;
        }
        .callout-pill {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.35rem 0.75rem;
            border-radius: 999px;
            background: rgba(255, 255, 255, 0.08);
            font-size: 0.95rem;
            line-height: 1.2;
        }
        .callout-pill svg {
            width: 1em;
            height: 1em;
            flex-shrink: 0;
        }
        .callout-pill--warn {
            border: 1px solid rgba(255, 193, 7, 0.7);
            color: #ffdd57;
        }
        .callout-pill--ok {
            border: 1px solid rgba(76, 175, 80, 0.7);
            color: #b2ff8f;
        }

        @media print {
            .reveal .controls,
            .reveal .progress,
            .reveal .overview,
            .reveal .slide-number { display: none !important; }
            pre code { font-size: 10pt !important; }
        }
    </style>
</head>
<body>
<div class="reveal">
    <div class="slides">

        <!-- Simple demo slide -->
        <section>
            <h2>h2 <code>title</code></h2>
            <p class="fragment">paragraph fragment (comes in before the code block)</p>

            <div class="code-block fragment large-mono">
<pre><code class="language-properties"># .env.local (gitignored)
MAILER_DSN=smtp://localhost
</code></pre>
            </div>
            <aside class="notes">
                Stress: never commit real API keys. Use secrets vault or env vars in CI. Show how to add .env.local to .gitignore if needed.
            </aside>
        </section>

        <section>
            <h2>h2 title</h2>
            <ul>
                <li class="fragment">li class="fragment" #1</li>
                <li class="fragment">li class="fragment" #2</li>
            </ul>
            <aside class="notes">Aside notes</aside>
        </section>

        <!-- Title -->
        <section>
            <h1>Install & Use: <code>example/bundle</code></h1>
            <p class="lead">A practical walkthrough — environment, install, config, maker commands, data</p>
            <p class="fragment">Speaker: Your Name • <small>Symfony 7.3 / PHP 8.4</small></p>
            <aside class="notes">
                Quick opener: explain scope — "fake bundle" that provides an API client + CLI & services.
            </aside>
        </section>

        <!-- Agenda -->
        <section>
            <h2>Agenda</h2>
            <ul>
                <li class="fragment">Environment & .env.local</li>
                <li class="fragment">Install with Composer</li>
                <li class="fragment">Configure YAML & API key</li>
                <li class="fragment">Maker commands: controller, entity, migration</li>
                <li class="fragment">Get data (wget) & use the bundle</li>
                <li class="fragment">Best practices</li>
            </ul>
            <aside class="notes">Mention time estimates and demo plan.</aside>
        </section>

        <!-- .env.local -->
        <section>
            <h2>Step 1 — Local environment: <code>.env.local</code></h2>
            <div class="code-block fragment large-mono">
<pre><code class="language-properties"># .env.local (gitignored)
APP_ENV=dev
DATABASE_URL="postgresql://db_user:db_pass@127.0.0.1:5432/my_db?serverVersion=17&charset=utf8"
EXAMPLE_BUNDLE_API_KEY="put-your-api-key-here"
# Optional overrides
MAILER_DSN=smtp://localhost
</code></pre>
            </div>

            <p class="fragment">Keep secrets out of repo. Use <code>.env.local</code> for machine-specific values.</p>

            <div class="callout-row">
                <div class="callout-pill callout-pill--ok fragment">
                    <!-- check-circle icon -->
                    <svg viewBox="0 0 16 16" aria-hidden="true">
                        <path fill="currentColor" d="M8 0a8 8 0 1 0 8 8A8.009 8.009 0 0 0 8 0m3.707 6.293l-4 4a1 1 0 0 1-1.414 0l-2-2L5 7.586 6.293 8.88 9.293 5.88z"/>
                    </svg>
                    <span>Use <code>.env.local</code> for secrets — never commit real API keys.</span>
                </div>
            </div>

            <div class="callout-row">
                <div class="callout-pill callout-pill--ok fragment">
                    <!-- check-circle icon -->
                    <svg viewBox="0 0 16 16" aria-hidden="true">
                        <path fill="currentColor" d="M8 0a8 8 0 1 0 8 8A8.009 8.009 0 0 0 8 0m3.707 6.293l-4 4a1 1 0 0 1-1.414 0l-2-2L5 7.586 6.293 8.88 9.293 5.88z"/>
                    </svg>
                    <span>The <code>Symfony Vault</code> is a good alternative.</span>
                </div>
            </div>

            <aside class="notes">
                Speaker note: also mention Symfony secrets vault if the audience knows it.
            </aside>
        </section>

        <!-- Composer install -->
        <section>
            <h2>Step 2 — Install the bundle</h2>
            <p class="fragment">Use Composer to require the package (CDN or Packagist example)</p>

            <div class="code-block fragment large-mono">
<pre><code class="language-bash"># from project root
composer require example/bundle
# If package has recipe, Symfony will auto-configure services.
</code></pre>
            </div>

            <aside class="notes">
                Mention: pin a specific version in production, e.g. composer require example/bundle:^1.2.0
            </aside>
        </section>

        <!-- YAML config -->
        <section>
            <h2>Step 3 — Configure YAML (services / bundle config)</h2>
            <p class="fragment">Place bundle config in <code>config/packages/example_bundle.yaml</code></p>

            <div class="code-block fragment large-mono">
<pre><code class="language-yaml"># config/packages/example_bundle.yaml
example_bundle:
  api_key: '%env(EXAMPLE_BUNDLE_API_KEY)%'
  endpoint: 'https://api.example.org/v1'
  options:
    timeout: 10
    retries: 2

services:
  Example\Integration\Client:
    arguments:
      $baseUri: '%example_bundle.endpoint%'
      $apiKey: '%example_bundle.api_key%'
</code></pre>
            </div>
            <aside class="notes">
                Explain <code>%env()%</code> usage, DI autowiring, and where to document config.
            </aside>
        </section>

        <!-- PHP constructor snippet -->
        <section>
            <h2>Step 4 — Example PHP usage: constructor & DI</h2>
            <p class="fragment">Typical PHP 8.4 service that receives HttpClient + config</p>

            <div class="code-block fragment large-mono">
<pre><code class="language-php">// src/Service/ExampleClient.php
namespace App\Service;

use Symfony\Contracts\HttpClient\HttpClientInterface;

class ExampleClient
{
    private HttpClientInterface $http;
    private string $baseUri;
    private ?string $apiKey;

    public function __construct(
        HttpClientInterface $http,    // injected HttpClient
        string $baseUri,              // injected from config
        ?string $apiKey = null        // optional API key
    ) {
        $this->http = $http;
        $this->baseUri = rtrim($baseUri, '/');
        $this->apiKey = $apiKey;
    }

    // Simple example method
    public function fetch(string $path): array
    {
        $response = $this->http->request('GET', $this->baseUri . '/' . ltrim($path, '/'), [
            'headers' => $this->apiKey ? ['Authorization' => 'Bearer ' . $this->apiKey] : [],
            'query' => []
        ]);

        return $response->toArray();
    }
}
</code></pre>
            </div>

            <p class="fragment">Tip: prefer constructor injection, typed properties, and default <code>null</code> for optional values.</p>
            <aside class="notes">
                Call out: using HttpClientInterface from Symfony — more testable than curl directly.
            </aside>
        </section>

        <!-- Maker commands -->
        <section>
            <h2>Step 5 — Use Maker: controllers, entities, migrations</h2>

            <div class="code-block fragment large-mono">
<pre><code class="language-bash"># Create a controller
bin/console make:controller ExampleController

# Create an entity (interactive)
bin/console make:entity ExampleItem

# Create a migration
bin/console make:migration

# Apply migration
bin/console doctrine:migrations:migrate
</code></pre>
            </div>

            <p class="fragment">If you create entities, keep your migrations small and review diffs before applying.</p>
            <aside class="notes">
                Mention <code>--regenerate</code> and <code>--format</code> flags if your project uses them. Recommend staging DB.
            </aside>
        </section>

        <!-- Developer tools & wget -->
        <section>
            <h2>Step 6 — Developer tools & data</h2>

            <div class="code-block large-mono">
<pre><code class="language-bash"># Add maker & debugging tools (dev)
composer require --dev symfony/maker-bundle symfony/debug-bundle

# Example: download a sample dataset for local testing
wget -O data/sample.json https://example.org/datasets/sample.json

# Import or load the data via CLI or custom command:
php bin/console app:import:data data/sample.json
</code></pre>
            </div>

            <p class="fragment">Best practice: include a small sample dataset in the repo (fixtures) for reproducible demos.</p>
            <aside class="notes">
                Show where to add fixtures and how seeds live in tests/fixtures or data/seed.
            </aside>
        </section>

        <!-- API key best practices -->
        <section>
            <h2>Step 7 — Adding an API key safely</h2>
            <ul>
                <li class="fragment">Don't commit keys — use <code>.env.local</code> (gitignored) or secrets manager</li>
                <li class="fragment">For CI, store secrets in CI settings and inject as env variables</li>
                <li class="fragment">Rotate keys and give least privilege</li>
            </ul>

            <div class="code-block fragment large-mono">
<pre><code class="language-bash"># Example: set env var on Linux/macOS
export EXAMPLE_BUNDLE_API_KEY="xxxxxx"

# Example: GitHub Actions (workflow secret)
# env:
#   EXAMPLE_BUNDLE_API_KEY: ${{ secrets.EXAMPLE_BUNDLE_API_KEY }}
</code></pre>
            </div>

            <aside class="notes">
                If using Docker, show how to pass build args or docker-compose env_file.
            </aside>
        </section>

        <!-- Live usage example -->
        <section>
            <h2>Step 8 — Using the client in a controller</h2>

            <div class="code-block large-mono fragment">
<pre><code class="language-php">// src/Controller/ExampleController.php
namespace App\Controller;

use App\Service\ExampleClient;
use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\Routing\Annotation\Route;

class ExampleController extends AbstractController
{
    #[Route('/example', name: 'example')]
    public function index(ExampleClient $client): Response
    {
        $data = $client->fetch('items');
        return $this->json($data);
    }
}
</code></pre>
            </div>
            <aside class="notes">
                Show small curl example to demo endpoint: <code>curl -s http://localhost:8000/example | jq .</code>
            </aside>
        </section>

        <!-- Property hooks / ApiPlatform callouts -->
        <section>
            <h2>Modern Symfony & ApiPlatform notes</h2>

            <div class="callout-row">
                <div class="callout-pill callout-pill--ok fragment">
                    <!-- lightning icon -->
                    <svg viewBox="0 0 16 16" aria-hidden="true">
                        <path fill="currentColor" d="M7 0L1 9h4l-1 7 6-9H7l2-7z"/>
                    </svg>
                    <span><strong>Property hooks</strong> — PHP&nbsp;8.4+ only; prefer hooks over legacy getters/setters.</span>
                </div>

                <div class="callout-pill callout-pill--warn fragment">
                    <!-- warning triangle -->
                    <svg viewBox="0 0 16 16" aria-hidden="true">
                        <path fill="currentColor" d="M7.938 2.016a1 1 0 0 1 1.124 0l6.857 4.857A1 1 0 0 1 15.857 9H.143A1 1 0 0 1 .081 6.873z"/>
                        <path fill="currentColor" d="M8 5c.552 0 1 .448 1 1v3c0 .552-.448 1-1 1s-1-.448-1-1V6c0-.552.448-1 1-1m0 7a1.25 1.25 0 1 1 0 2.5A1.25 1.25 0 0 1 8 12"/>
                    </svg>
                    <span><strong>ApiFilter</strong> is deprecated in ApiPlatform 5 — use <code>filters</code> on <code>#[ApiResource]</code> / <code>#[ApiProperty]</code> instead.</span>
                </div>
            </div>

            <aside class="notes">
                Use this slide to reset expectations about "modern" examples in the rest of the deck.
            </aside>
        </section>

        <!-- Code + explanation: #[ApiResource] -->
        <section>
            <h2>Code + explanation: <code>#[ApiResource]</code> with filters</h2>

            <div class="code-block fragment large-mono">
<pre><code class="language-php">use ApiPlatform\Metadata\ApiResource;
use ApiPlatform\Metadata\ApiFilter;
use ApiPlatform\Doctrine\Orm\Filter\SearchFilter;

#[ApiResource(
    // ApiFilter is deprecated in ApiPlatform 5
    // use "filters" instead, e.g. filters: ['user.search_filter']
)]
#[ApiFilter(SearchFilter::class, properties: [
    'email' => 'ipartial',
    'active' => 'exact',
])]
class User
{
    public function __construct(
        public readonly string $id,
        public string $email,
        public bool $active = true,
    ) {}
}
</code></pre>
            </div>

            <p class="fragment">
                In ApiPlatform&nbsp;5, prefer configuring filters via <code>filters</code> on <code>#[ApiResource]</code>
                or via resource metadata, instead of <code>#[ApiFilter]</code> attributes.
            </p>
            <aside class="notes">
                You can show the "legacy" attribute style here, then pivot to the recommended configuration in 5.x.
            </aside>
        </section>

        <!-- Quick debugging checklist -->
        <section>
            <h2>Quick debugging checklist</h2>
            <ul>
                <li class="fragment">1. Are env vars loaded? <code>bin/console debug:container --env=dev</code></li>
                <li class="fragment">2. Check service wiring: <code>bin/console debug:container Example\\Service\\ExampleClient</code></li>
                <li class="fragment">3. HTTP calls failing? Inspect logs & profiler</li>
                <li class="fragment">4. Migration issues? Check SQL with <code>bin/console doctrine:migrations:diff</code></li>
            </ul>
            <aside class="notes">Demonstrate <code>bin/console</code> debug tools during the talk if time permits.</aside>
        </section>

        <!-- Best practices -->
        <section>
            <h2>Best practices & tips</h2>
            <ul>
                <li class="fragment">Keep code snippets short and testable</li>
                <li class="fragment">Provide a <code>README.md</code> with exact commands for reproducibility</li>
                <li class="fragment">Add small sample dataset & automated tests</li>
                <li class="fragment">Document config keys and defaults clearly</li>
                <li class="fragment">Use feature flags or environment checks to avoid hitting production APIs in demos</li>
            </ul>
            <aside class="notes">Also mention semantic versioning for the bundle and changelog practices.</aside>
        </section>

        <!-- Summary -->
        <section>
            <h2>Summary</h2>
            <ol>
                <li class="fragment">Set <code>.env.local</code> and keep secrets out of repo</li>
                <li class="fragment"><code>composer require</code> → configure YAML → DI</li>
                <li class="fragment">Use maker commands to scaffold controllers/entities</li>
                <li class="fragment">Load sample data and test endpoints</li>
            </ol>

            <p class="fragment">Thanks — questions?</p>
            <aside class="notes">Open demo or Q&amp;A. Provide repo link in chat or slide deck footer if you host it.</aside>
        </section>

        <!-- Footer / resources -->
        <section>
            <h3>Resources &amp; Templates</h3>
            <ul>
                <li class="fragment">Reveal.js docs: https://revealjs.com</li>
                <li class="fragment">Symfony Maker: https://symfony.com/doc/current/bundles/MakerBundle.html</li>
                <li class="fragment">Symfony HttpClient: https://symfony.com/doc/current/http_client.html</li>
            </ul>
            <p class="fragment">Repo template available on request.</p>
        </section>

    </div>
</div>

<!-- Reveal.js scripts -->
<script src="https://unpkg.com/reveal.js@4/dist/reveal.js"></script>

<!-- highlight.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>

<script>
    // Initialize highlight.js
    hljs.highlightAll();

    // Ensure fragments on each slide appear strictly in DOM order
    // (heading → text → bullets → code → callouts, etc.)
    document.querySelectorAll('.reveal .slides section').forEach(section => {
        const fragments = section.querySelectorAll('.fragment');
        fragments.forEach((el, idx) => {
            el.setAttribute('data-fragment-index', String(idx));
        });
    });

    // Initialize Reveal
    Reveal.initialize({
        hash: true,
        width: 1200,
        height: 800,
        margin: 0.06,
        minScale: 0.2,
        maxScale: 1.2,
        transition: 'slide',
        dependencies: [
            { src: 'https://unpkg.com/reveal.js@4/plugin/notes/notes.js', async: true },
            { src: 'https://unpkg.com/reveal.js@4/plugin/markdown/markdown.js', async: true },
            { src: 'https://unpkg.com/reveal.js@4/plugin/search/search.js', async: true }
        ]
    });
</script>
</body>
</html>
